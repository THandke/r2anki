---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
```

```{r}
## install.packages("tidyverse")
```

```{r}
# read test_sourcefile
tf <- readLines("05-Atomics.Rmd")
tf

# parse tasks
l_task <- grep("####", tf)  # line of task  [alternative: grep("**Task**")]
tf[l_task]

# parse code
l_code   <- grep("```", tf)   # start and end lines of code-chunk
l_code_s <- l_code[seq(1, length(l_code), 2)]  # all start lines
l_code_e <- l_code[seq(2, length(l_code), 2)]  # all end lines
```

```{r}
# create an empty data frame
tf_dat <- data.frame(l_task   = integer(),
                     task     = character(),
                     l_code_s = integer(),
                     l_code_e = integer(),
                     stringsAsFactors = FALSE)
 
# write to the table
tf_dat[seq_along(l_task), "l_task"] <- l_task
tf_dat[seq_along(l_task), "task"] <- tf[l_task]
tf_dat[seq_along(l_code_s), "l_code_s"] <- l_code_s
tf_dat[seq_along(l_code_e), "l_code_e"] <- l_code_e

  # define a function to get code-content
get_code <- function(i){
  tf[seq(l_code_s[i] + 1, l_code_e[i] - 1, 1)]
}

tf_dat["code"] <- map(seq_along(l_code_s), get_code) %>% list

## todo
# create tibble
```



## parse multiple files
```{r, eval=FALSE}
## Create two text files with content 
filenames <- c( tempfile(), tempfile() )
for( f in  filenames ){
 cat("We wish you a Merry Christmas!\n\nBest regards\n", file=f)
}

## Replace Merry Christmas with Happy New Year
for( f in filenames ){

  x <- readLines(f)
  y <- gsub( "Merry Christmas", "Happy New Year", x )
  cat(y, file=f, sep="\n")

}

## Review output
for( f in filenames ){ 
   cat(readLines(f), sep="\n")
}
```
